{
  "agent_id": "coder3",
  "task_id": "task_3",
  "files": [
    {
      "name": "memory.py",
      "purpose": "Experience replay and memory",
      "priority": "medium"
    },
    {
      "name": "reward_system.py",
      "purpose": "Reward calculation and shaping",
      "priority": "medium"
    }
  ],
  "project_info": {
    "project_name": "enhanced_cs.SY_2508.08153v1_Robust_Adaptive_Discrete_Time_Control_Barrier_Cert",
    "project_type": "agent",
    "description": "Enhanced AI project based on cs.SY_2508.08153v1_Robust-Adaptive-Discrete-Time-Control-Barrier-Cert with content analysis. Detected project type: agent (confidence score: 10 matches).",
    "key_algorithms": [
      "Against",
      "Metric",
      "Continuous-Time",
      "Maximized",
      "Cbf",
      "Safe",
      "Machine",
      "Functions",
      "Online",
      "Active"
    ],
    "main_libraries": [
      "torch",
      "numpy",
      "pandas"
    ]
  },
  "paper_content": "PDF: cs.SY_2508.08153v1_Robust-Adaptive-Discrete-Time-Control-Barrier-Cert.pdf\nChunk: 1/1\n==================================================\n\n--- Page 1 ---\nRobust Adaptive Discrete-Time Control Barrier Certificate\u22c6\nChangrui Liua, Anil Alana, Shengling Shia, Bart De Schuttera\naDelft Center for Systems and Control, TU Delft, Delft, The Netherlands.\nAbstract\nThis work develops a robust adaptive control strategy for discrete-time systems using Control Barrier Functions (CBFs)\nto ensure safety under parametric model uncertainty and disturbances. A key contribution of this work is establishing a\nbarrier function certificate in discrete time for general online parameter estimation algorithms. This barrier function certificate\nguarantees positive invariance of the safe set despite disturbances and parametric uncertainty without access to the true\nsystem parameters. In addition, real-time implementation and inherent robustness guarantees are provided. Our approach\ndemonstrates that, using the proposed robust adaptive CBF framework, the parameter estimation module can be designed\nseparately from the CBF-based safety filter, simplifying the development of safe adaptive controllers for discrete-time systems.\nThe resulting safety filter guarantees that the system remains within the safe set while adapting to model uncertainties, making\nit a promising strategy for real-world applications involving discrete-time safety-critical systems.\nKey words: robust adaptive control; data-driven safety; discrete-time control barrier function; online learning\n1 Introduction\nEnsuring the safety of dynamical systems is a fundamen-\ntal requirement in modern control applications, partic-\nularly in domains where violations of safety constraints\ncan lead to undesirable outcomes [4], [36]. Safety-critical\ncontrol focuses on the synthesis of controllers guarantee-\ning that the system remains within a safe set. Among\nvarious approaches (e.g., Hamilton-Jacobi reachability\nanalysis [5], penalty functions [33], and Model Predic-\ntive Control (MPC) [20], [30]), Control Barrier Func-\ntions (CBFs) have emerged as a powerful and system-\natic tool to enforce safety for both continuous-time [4]\nand discrete-time systems [2]. CBF-based control meth-\nods allow the formal encoding of safety constraints, and\nthey have found wide-ranging applications, including au-\ntonomous driving [8], robotics [16], and power systems\n[41], demonstrating their versatility and practical rele-\nvance in safety-critical domains.\n\u22c6This paper is part of a project that has received funding\nfrom the European Research Council (ERC) under the Eu-\nropean Union\u2019s Horizon 2020 research and innovation pro-\ngramme (Grant agreement No. 101018826 - CLariNet), and\nit was not presented at any IFAC meeting. Corresponding\nauthor: Changrui Liu. Tel. +31 15 27 82292.\nEmail addresses: c.liu-14@tudelft.nl (Changrui Liu),\na.alan@tudelft.nl (Anil Alan), s.shi-3@tudelft.nl\n(Shengling Shi), b.deschutter@tudelft.nl (Bart De\nSchutter).Despite the recent surge in learning-based approaches for\nsafety-critical control [35], model-based methods using\nCBFs remain essential due to their analytical tractabil-\nity, real-time implementability, and formal safety guar-\nantees [4], [43]. These approaches allow for rigorous con-\ntroller design based on dynamical models [2], [4], [46],\nmaking them highly attractive for safety-critical appli-\ncations. However, a fundamental challenge in deploy-\ning model-based CBFs is the presence of model uncer-\ntainty, which can compromise safety if not properly ad-\ndressed [43]. To mitigate this, various extensions have\nbeen developed that incorporate robust and/or adaptive\nmechanisms against disturbances [12], [13], [18], [48] or\nparametric uncertainty [24], [25], [34], [38], [44]. Specifi-\ncally, for safe control under disturbances, verifiable cer-\ntificates have been established to ensure safety with high\nprobability for unbounded stochastic disturbances [12],\n[13] and guaranteed safety for bounded disturbances\n[18], [48]. On the other hand, recent results on adaptive\nsafety under parametric model mismatch have been ob-\ntained using CBFs with online parameter updates, em-\nploying either Lyapunov-based methods [24], [25], [38],\n[44] or batched least-squares methods [34]. For an in-\ndepth overview, we refer the reader to [43].\nAlthough recent developments are promising, to the\nbest of the authors\u2019 knowledge, existing results on\nadaptive safety for handling parametric uncertainty are\nlimited to continuous-time settings [24], [25], [34], [38],\n[44], while the discrete-time adaptive case remains un-\nPreprint submitted to Automatica 12 August 2025arXiv:2508.08153v1  [eess.SY]  11 Aug 2025\n\n--- Page 2 ---\nexplored. Given the widespread use of digital controllers\nand discrete-time formulations in practice\u2014such as\nin MPC and reinforcement learning [42]\u2014it is critical\nto develop adaptive safety control within a Discrete-\nTime CBF (DT-CBF) framework to bridge this gap.\nMoreover, such discrete-time frameworks are more com-\npatible with real-world applications with discrete-time\nsensing and actuation [12], [32].\nSince time derivatives are not available in discrete time,\nthe main challenge lies in establishing all results using\ndifference equations and inequalities. Moreover, a causal\nsynthesis of the online safe controller must be ensured\nsuch that no future data is required for computing the\ncontrol input., which is an important aspect that is miss-\ning when continuous-time models are used [25], [34]. On\nthe other hand, Lyapunov-based adaptation laws often\nlack guarantees on the boundedness of the parameter\nestimates [44] or convergence to the true parameters\n[25], making estimation-based approaches more appeal-\ning [10], [44]. Since many simple and effective estima-\ntion or identification methods (e.g., least-squares tech-\nniques) require access to sampled data [23], a DT-CBF\nframework is naturally better suited for leveraging these\nmethods. In this paper, we address this theoretical gap\nby developing a DT-CBF framework for adaptive safety.\nOur approach extends model-based safe adaptive con-\ntrol to a broader class of systems\u2014particularly those im-\nplemented in embedded or sampled-data settings\u2014and\nlays the groundwork for online safe control in real-world\nsystems with uncertain models. Specifically, the contri-\nbutions of this work can be summarized as follows:\n\u2022We develop a robust adaptive Control Barrier Cer-\ntificate (CBC) for input-affine discrete-time systems\nsubject to both bounded disturbances and parametric\nmodel mismatch. To the best of our knowledge, this\nis the first result on adaptive safety using DT-CBF.\n\u2022The proposed certificate accommodates general online\nadaptation laws that are decoupled from the CBF-\nbased controller synthesis, enabling a modular control\narchitecture in the spirit of [9]. This new insight\u2014\nsimilar to the separation principle in the control and\nestimation for linear systems [39]\u2014has not been re-\nvealed in existing results [25], [34].\n\u2022The inherent robustness1of the proposed robust\nadaptive control approach using DT-CBF is rigor-\nously analyzed, extending existing robustness guaran-\ntees for continuous-time systems with time-invariant\ncontrol barrier certificates [46].\nThe rest of the paper is organized as follows. Section 2\nprovides preliminaries. Section 3 introduces the robust\n1In this paper, inherent robustness refers to steering the\nstate towards a safe set when the current state is unsafe [46,\nSection 2.2], which should not be confused with robustness\nagainst model uncertainty [15], [25].adaptive CBC using DT-CBFs. A simple online estima-\ntion algorithm based on Recursive Least Squares (RLS)\nis briefly given in Section 4. Inherent robustness guar-\nantees are discussed in Section 5. A simulation example\nis presented in Section 6, and Section 7 concludes the\npaper and outlines future research directions.\n2 Preliminaries\nThis section introduces robust DT-CBFs, which consti-\ntute a natural and modest extension of continuous-time\nCBFs to discrete-time systems with bounded distur-\nbances, building on prior work on continuous-time sys-\ntems with bounded disturbances [18] and discrete-time\nsystems without disturbances [2].\n2.1 Notation\nThe sets of real and natural numbers are denoted, respec-\ntively, by RandN. The set of extended natural numbers\nisN=N\u222a {+\u221e}, and I[a:b]:=N\u2229[a, b]. The matrix\n(vector) p-norm is denoted by \u2225\u00b7\u2225pwith p\u2208 {1,2}, and\n\u2225\u00b7\u2225represents the 2-norm by default. The i-th element of\na vector xis denoted by x[i]. The zero and one vectors of\nsizenare denoted by 0nand1n, respectively. A contin-\nuous function \u03b1:R\u2192Ris said to be an extended class\nK\u221efunction (denoted as \u03b1\u2208 K e,\u221e) if\u03b1(0) = 0, \u03b1is\nstrictly monotonically increasing, lim r\u2192\u2212\u221e \u03b1(r) =\u2212\u221e,\nand lim r\u2192+\u221e\u03b1(r) = + \u221e[38, Definition 7]. The class\nof functions \u03b2:R\u2192Rthat are sublinear w.r.t. identity\n(i.e., \u03b2(r)< rfor all r >0) is denoted by CSL. The pro-\njection operator \u03a0 X(\u00b7) and distance operator dist X(\u00b7)\nw.r.t. a set X \u2286Rnare defined, respectively, as \u03a0 X(\u00afx) =\narg min x\u2208X\u2225x\u2212\u00afx\u2225and dist X(\u00afx) = min x\u2208X\u2225x\u2212\u00afx\u2225for\nany \u00afx\u2208Rn. The minimum eigenvalue of a symmetric\npositive definite matrix \u0393 is denoted by \u03bbmin(\u0393).\n2.2 System description\nConsider a class of input-affine discrete-time systems de-\nscribed by the following model:\nxt+1=f(xt, ut;\u03b8) +wt\n=fd(xt)\u2212[\u03d5(xt)]\u22a4\u03b8+g(xt)ut+wt,(1)\nwhere xt\u2208 X \u2282 Rnandut\u2208 U \u2286 Rmare the state\nand input at time step twithXbeing compact and\nUbeing closed ,fd:X \u2192 Rndescribes the nominal\ndrift2,g:Rn\u2192Rn\u00d7mcharacterizes the input coupling,\nand [\u03d5(xt)]\u22a4\u03b8represents the additional drift term with\n\u03d5:Rn\u2192Rq\u00d7nbeing a continuous known kernel (i.e.,\nregressor) and \u03b8\u2208\u0398 being an unknown parameter. The\n2Although we consider discrete-time systems, we adopt the\nterm \u201cdrift\u201d from the \u201cdrift vector field\u201d used in nonlinear\ncontrol of input-affine continuous-time systems [29].\n2\n\n--- Page 3 ---\nconsidered model class in (1) can be used in many real-\nworld applications, e.g., inverted pendulum [27], throttle\ncontrol [37] and Adaptive Cruise Control (ACC) [38] in\nautomotive systems. In addition, the disturbance wtlies\nin a known polytope given by\nW={w\u2208Rn|Hww\u22641nw}, (2)\nwhere Hw\u2208Rnw\u00d7nandnwis the number of linear\ninequalities that define W. It is clear that 0nlies in the\ninterior of W, and we further define w:= max w\u2208W\u2225w\u2225.\nThe true parameter \u03b8\u2217\u2208\u0398 is a constant and the prior\nknown parameter set \u0398 is a polytope given by\n\u0398 ={\u03b8\u2208Rp|H\u03b8\u03b8\u2264h\u03b8}, (3)\nwhere H\u03b8\u2208Rn\u03b8\u00d7qandh\u03b8\u2208Rn\u03b8. Given an estimate\n\u02c6\u03b8\u2208\u0398, its associated estimation error is defined by\ne\u03b8:=\u02c6\u03b8\u2212\u03b8\u2217. (4)\nThe error e\u03b8cannot be computed exactly since \u03b8\u2217is\nunknown. However, for a specific estimate \u02c6\u03b8, an upper\nbound of the estimation error can be computed by solv-\ning the following non-convex optimization problem:\n\u03b5\u03b8(p) := max\n\u03b8\u2208\u0398\u2225\u03b8\u2212\u02c6\u03b8\u2225p, (5)\nand it holds that3\u2225e\u03b8\u2225 \u2264\u03b5\u03b8(2)\u2264\u03b5\u03b8(1). Following (1),\nthetruesystem under disturbances is given by\nxt+1=f(xt, ut;\u03b8\u2217) +wt, (6)\nassuming access to the true parameter \u03b8\u2217.\nRemark 1 The controller design for the model (1)does\nnot require the smoothness of the kernel \u03d5(\u00b7). Therefore,\nwith special non-smooth kernels, the model (1)can also\ndescribe PWA dynamics [28], [42], and our results can\nalso be used for safety-critical control of PWA systems.\n2.3 Robust safety certificate\nDefinition 1 (Robust safety) A set Xs\u2286 X is posi-\ntive invariant for (6)ifx0\u2208 Xsimplies that xt\u2208 Xsfor\nallt\u2208Nand all wt\u2208 W. In this case, the system (6)is\nrobustly safe w.r.t. Xs, andXsis called a safe set.\nCharacterizing safe sets using CBFs is useful for safe\ncontroller design [3], [4]. For discrete-time systems, DT-\nCBFs are powerful tools to achieve this objective [2], [13].\nSpecifically, given a continuous function B:X \u2192R, its\ninduced safe set is defined using the 0-superlevel set as\nSB:={x\u2208 X | B(x)\u22650}, (7)\nand its boundary \u2202SBand interior int( SB) are defined,\nrespectively, by\n\u2202SB:={x\u2208 X | B(x) = 0}, (8a)\nint(SB) :={x\u2208 X | B(x)>0}. (8b)\n3Given x\u2208Rn,\u2225x\u22252\u2264 \u2225x\u22251[17].In addition, to certify safety in the discrete-time setting,\nan additional continuity assumption is required, which\nis given as follows:\nAssumption 1 (Lipschitz continuity) The barrier\nfunction B:X \u2192 Ris locally Lipschitz continuous on\nthe state space X, i.e.,\n|B(x\u2032)\u2212B(x\u2032\u2032)| \u2264LB\u2225x\u2032\u2212x\u2032\u2032\u2225,\u2200x\u2032, x\u2032\u2032\u2208 X,(9)\nwhere LB\u22650is the Lipschitz constant.\nAssumption 1 has been used in the literature on discrete-\ntime CBFs [27], [48], and given that the commonly used\nCBFs are continuously differentiable [3], [4], Lipschitz\ncontinuity directly follows given that Xis compact. Be-\nsides, the CBFs used in many safe control applications\nare Lipschitz continuous [1], [25], [38], [48]. The func-\ntionBis a DT-CBF if it satisfies additional conditions\nw.r.t. the system (6). The following definition is adopted\nfrom [2] and [13] with modifications that suit discrete-\ntime models with bounded disturbances.\nDefinition 2 A continuous function B:X \u2192 Ris a\nrobust DT-CBF for (6)onSBif there exists \u03b1\u2208 Ke,\u221e\u2229\nCSLsuch that for all x\u2208 X, there exists u\u2208 Usatisfying\nB(f(x, u;\u03b8\u2217) +w)\u2212B(x)\u2212LBw\u2265 \u2212\u03b1(B(x)),(10)\nand(10)is called the robust CBC against disturbances.\nThe barrier certificate (10) also defines the set of robust\nsafe control inputs for SBas\nUrs(x;\u03b8\u2217) ={u\u2208 U | \u2200 w\u2208 W,(10) holds. },\nwhere \u03b8\u2217emphasizes that characterizing Urs(x;\u03b8\u2217) re-\nquires knowing the true parameter. The following the-\norem is a standard result on CBF-based safety guaran-\ntees, and the proof is omitted for brevity since it follows\nthe same procedure as in [2].\nTheorem 1 (Robust safety) If a continuous function\nB:X \u2192 Ris a robust DT-CBF for (6)onSB, then\nUrs(x;\u03b8\u2217)is non-empty for all x\u2208 X. In addition, if\na state-feedback control policy \u03c0:Rn\u2192Rmsatisfies\n\u03c0(x)\u2208 Urs(x;\u03b8\u2217),\u2200x\u2208 X, then the closed-loop system\nxt+1=f(xt, \u03c0(xt);\u03b8\u2217) +wtis robustly safe w.r.t. SB\nagainst disturbances wt.\nRemark 2 Contrary to the existing results on robust\nDT-CBFs with (unbounded) stochastic disturbances [12],\n[13], this paper focuses on bounded disturbances that can\nbe stochastic [28] or adversarial [1]. Accordingly, Defi-\nnitions 1 and 2 and Theorem 1 are tailored for robust\nsafety against bounded disturbances only, assuming the\ntrue parameter \u03b8\u2217is known to the controller.\nSince knowing \u03b8\u2217is a stringent requirement in general,\n(10) cannot be used to synthesize safe controllers when\n\u03b8\u2217is unknown. In such cases, a straightforward remedy is\n3\n\n--- Page 4 ---\nto additionally robustify against maximized model mis-\nmatch and use a constant nominal \u02c6\u03b8to build the CBF\ncondition. Accordingly, similar to Theorem 1, a corre-\nsponding worst-case robust safety guarantee can be es-\ntablished. However, controllers designed based on such\nworst-case safety condition may not respond to dan-\ngerous system behaviors as fast as its counterpart that\nknows the true model, and more conservative inputs are\nthen needed to guarantee safety. Considering that para-\nmetric uncertainty is epistemic in nature [43] and can\nbe reduced or even eliminated through the acquisition of\ndata, it is thus beneficial to develop an adaptive barrier\ncertificate that can be used for safe control synthesis.\n3 Robust adaptive safety\nIn this section, we introduce robust adaptive safety guar-\nantees with general online parameter adaptation laws.\nMore specifically, a robust adaptive CBC is formulated\nthat only relies on an instantaneous parameter estimate\nand the associated adaptation law. This proposed cer-\ntificate ensures robust safety against both parametric\nmodel mismatch and disturbances with reduced conser-\nvatism due to the adaptation mechanism.\n3.1 Online parameter estimation\nAt each time step t, consider a parameter estimation\nmodule ESTthat can provide a polytopic set estimate\n\u0398t\u2286\u0398 such that \u03b8\u2217\u2208\u0398tand a point estimate \u02c6\u03b8t\u2208\u0398t.\nFollowing (4) and (5), the instantaneous estimation error\nand its associated error bound are defined as follows:\ne\u03b8,t:=\u02c6\u03b8t\u2212\u03b8\u2217, (11a)\n\u03b5\u03b8,t(p) := max\n\u03b8\u2208\u0398t\u2225\u03b8\u2212\u02c6\u03b8t\u2225p. (11b)\nThe module ESTperforms a recursive point-estimate up-\ndate specified by the following abstracted update law:\n\u02c6\u03b8t+1=TADP,t(\u02c6\u03b8t), (12)\nwhere TADP,t(\u00b7) is time-varying since the closed-loop\ninput-state data is collected online and the set estimate\n\u0398twill also be used to determine the point estimate.\nFinally, the point-estimate increment is defined by\n\u03b4\u03b8,t:=\u02c6\u03b8t+1\u2212\u02c6\u03b8t=TADP,t(\u02c6\u03b8t)\u2212\u02c6\u03b8t, (13)\nwhich will be used to build the barrier certificate.\n3.2 Robust adaptive control barrier certificate\nGiven a baseline continuous barrier candidate B:X \u2192\nRthat encodes safety constraints and that defines a safe\nsetSBas (7), we define the corresponding robust adaptive\nbarrier function by\nBra,t(x) :=B(x)\u22121\n2e\u22a4\n\u03b8,t\u0393\u22121e\u03b8,t, (14)where \u0393 is a symmetric positive definite matrix. Accord-\ningly, the robust adaptive safe set Sra,tis defined by the\n0-superlevel set of Bra,t(\u00b7) as\nSra,t:={x\u2208 X | Bra,t(x)\u22650}, (15)\nand its boundary \u2202Sra,tand interior int( Sra,t) are defined\nsimilar to (8a) and (8b), respectively. Besides, it is noted\nthat (14) implies that Sra,t\u2286 S, andSra,t=Sif and only\nif\u02c6\u03b8t=\u03b8\u2217. Since Sra,tis time-varying, a timed version of\nthe robust safety in Definition 1 is given as follows:\nDefinition 3 (Timed robust safety) Given T\u2208N, a\nsequence of sets {Xs,t}T\nt=0satisfying x0\u2208 Xs,0and\u2200t\u2208\nI[0:T],Xs,t\u2286 X is sequentially positively invariant for\n(6)if\u2200t\u2208I[0:T\u22121],xt\u2208 Xs,timplies that xt+1\u2208 Xs,t+1\nfor all wt\u2208 W. In this case, the system (6)is said to be\nrobustly safe w.r.t. {Xs,t}T\nt=0. In addition, if Xs,t=X\u2217\ns,\n\u2200t\u2208I[0:T], the system (6)is said to be robustly safe\nw.r.t.X\u2217\nsoverI[0:T\u22121].\nThe concept of imposing finite-horizon safety has been\nused in safe control using CBFs [12], [13]. In fact, the\ntimed safety in Definition 3 is more practical and general\nthan its infinite-horizon counterpart since safety usually\nneeds only be ensured over the duration of operation [32]\nand taking T= +\u221erecovers infinite-horizon safety.\nRemark 3 In this work, we consider a general barrier\nfunction B(\u00b7), instead of a parameter-dependent barrier\nfunction B(\u00b7;\u03b8)as in [25], [38]. In fact, model-free CBFs\nthat are derived solely based on the safety requirements\nhave been used in many real-world safe control applica-\ntions, e.g., ACC [25], [38], aircraft pitch control [25], and\naerial robotics [48]. This framework also avoids repeat-\nedly constructing barrier functions B(\u00b7;\u02c6\u03b8t)online based\non\u02c6\u03b8t, which can be computationally expensive [35].\nSince \u03b8\u2217is unknown, e\u03b8,tcannot be computed, and thus\nSra,tcannot be explicitly characterized. However, Sra,t\nonly serves as a fictitious set that will be used to realize\nsafety characterized by B(\u00b7), as will be manifested in\nTheorem 2. Next, we present the robust adaptive CBC,\nwhich certifies B(\u00b7) as a barrier function for a system in\nthe presence of bounded disturbances and parameteric\nuncertainty with adaptation. In addition, this CBC can\nbe used in the safety filter framework [4].\nDefinition 4 (Robust adaptive CBC) Let Assump-\ntion 1 hold. Given ESTandT\u2208N, a continuous function\nB:X \u2192Ris a robust adaptive DT-CBF for (6)andEST\non{Sra,t}T\nt=0if there exists \u03b1\u2208 K e,\u221e\u2229 CSLsuch that,\nfor all x\u2208 X, there exists u\u2208 Usatisfying\nB\u0000\nf(x, u;\u02c6\u03b8t)\u0001\n\u2212B(x)\u2212LBw\u2212E\u03b8,t(x)\n\u2265 \u2212\u03b1\u0012\nB(x)\u2212(\u03b5\u03b8,t(p))2\n2\u03bbmin(\u0393)\u0013\n,\u2200t\u2208I[0:T\u22121],(16)\n4\n\n--- Page 5 ---\nwhere E\u03b8,t(x)=\u0010\nLB\u2225\u03d5(x)\u2225+\u2225\u03b4\u03b8,t\u2225\n\u03bbmin(\u0393)\u0011\n\u03b5\u03b8,t(p) +\u2225\u03b4\u03b8,t\u22252\n2\u03bbmin(\u0393)\nwithLBbeing the Lipschitz constant in (9)and\u03b4\u03b8,tchar-\nacterized by the estimation module EST. In this case, the\ncondition (16)is called the robust adaptive CBC against\ndisturbances and parametric model mismatch.\nThe certificate (16) also defines a set of robust adaptive\nsafe control inputs for {Sra,t}T\nt=0as\nUras(x;\u02c6\u03b8t, p) ={u\u2208 U | (16) holds }, (17)\nwhere the parametric dependency on \u02c6\u03b8tindicates that\ncharacterizing the robust adaptive safe control set only\nrequires the online estimate \u02c6\u03b8twithout knowing the true\n\u03b8\u2217. In essence, Uras(x;\u02c6\u03b8t, p) is time-varying and it de-\npends on the estimation module EST. Robust adaptive\nsafety is summarized in the following theorem:\nTheorem 2 (Robust adaptive safety) Let Assump-\ntion 1 hold and assume x0\u2208 Sra,0. Given ESTandT\u2208N,\nifBis a robust adaptive DT-CBF for the system (6)\nandESTon{Sra,t}T\nt=0, then the set Uras(x;\u02c6\u03b8t, p)is non-\nempty for all x\u2208 X and all t\u2208I[0,T\u22121]. In addition, if\na sequence of time-varying state-feedback control policies\n\u03c0t:X \u2192Rm, t\u2208I[0,T\u22121]satisfies \u03c0t(x)\u2208 Uras(x;\u02c6\u03b8t, p)\nfor all x\u2208 X, then the time-varying closed-loop system\nxt+1=f(xt, \u03c0t(xt);\u03b8\u2217) +wt (18)\nis robustly safe w.r.t. {Sra,t}T\nt=0and thus robustly safe\nw.r.t.SBoverI[0:T](cf. Definition 3) against both para-\nmetric model mismatch and disturbances.\nThe proof of Theorem 2 is given in Appendix A. It is\nworth noting that the certificate (16) requires only \u02c6\u03b8t\nand\u03b5\u03b8,t(p), without needing knowledge of \u03b8\u2217. This ad-\nvantage makes (16) more readily applicable for CBF-\nbased controller synthesis. Specifically, given a nominal\nstate-feedback policy \u03c0nom,t:X \u2192Rmat time step t, a\nrobust adaptive safe policy \u03c0ras,t:X \u2192 U is implicitly\ngiven by the following safety filter:\n\u03c0ras,t(x;p) = arg min\n\u03bd\u2208Uras(x;\u02c6\u03b8t,p)\u2225\u03bd\u2212\u03c0nom,t(x)\u2225. (19)\nUnder \u03c0ras,t(\u00b7), the closed-loop system becomes\nxt+1=f(xt, \u03c0ras,t(xt;p);\u03b8\u2217) +wt. (20)\nRemark 4 The robust adapitve CBF (14)is built using\nthe true parametric error e\u03b8,tinstead of the set-induced\nerror bound as in [25]. In fact, unlike what has been re-\nported in [25], the invariance property of the safe sets\ndefined by the maximized error bound-based robust adap-\ntive CBFs can only be derived in discrete time, but not in\ncontinuous time. More details are given in Appendix B.\n3.3 Practical implementation\nIn general, it is not possible to obtain an analytical ex-\npression of the safe policy \u03c0ras,t(\u00b7;p). However, in prac-\ntice, it suffices to only numerically compute a single safeinput uras,t(p) =\u03c0ras,t(xt;p) by solving (19) for a spe-\ncificxtat time step t. Efficient computation of uras,t(p)\nrequires fast characterization of Uras(xt;\u02c6\u03b8t, p) by estab-\nlishing the inequality (16), which depends on xt,\u02c6\u03b8t, and\n\u03b5\u03b8,t(p). However, computing \u03b5\u03b8,t(2) requires solving a\nnon-convex optimization problem. An alternative is us-\ning\u03b5\u03b8,t(1), since then the optimization problem in (11b)\ncan be reformulated as a linear program and solved ef-\nficiently [40]. However, since \u03b5\u03b8,t(2)\u2264\u03b5\u03b8,t(1), it follows\nthatUras(x;\u02c6\u03b8t,1)\u2286 Uras(x;\u02c6\u03b8t,2) for all x\u2208 X, meaning\nthe CBC (16) with \u03b5\u03b8,t(1) is more conservative.\nRemark 5 Employing \u03b5\u03b8,t(1)in(16) results in a more\nconservative safe controller. Thus, uras,t(1)is likely to be\nmore suboptimal than uras,t(2), especially in the context\nof optimal control when the policy \u03c0nom,tis (implicitly)\ngiven by methods using discrete-time control Lyapunov\nfunctions (CLFs) [6] or MPC [20], [21], [30].\nIn general, the optimization problem of the safety fil-\nter (19) is non-convex and cannot be solved efficiently.\nTo address this issue, it is beneficial to construct a con-\ncave barrier candidate B(\u00b7) such that Uras(x;\u02c6\u03b8t, p) is\nconvex, and thus computing uras,t(p) requires solving a\nconvex optimization problem, for which many efficient\nalgorithms with convergence and optimality guarantees\nexist [7]. Note that concavity of B(\u00b7) is frequently as-\nsumed for DT-CBFs in the literature [2], [14], [47].\n4 Online identification & Causal Synthesis\nIn this section, following the adaptive control approach\nfor linear systems [26], we instantiate an estimator EST\nusing the least-squares-based recursive update with set-\nmembership projection [19]. In addition, we present a\ncausal integration of the safety filter and the estimator\nto guarantee that computing uras,t(p) does not rely on\nany information from time step t+ 1 onward.\nFort\u22651, both \u02c6\u03b8tand \u0398 tare determined by the informa-\ntion flow Ft\u22121:= (x0, u0, x1, u1, . . . , x t\u22121), and a causal\nsynthesis means computing utbased on Ft. The initial\nestimate satisfies \u02c6\u03b80\u2208\u03980with \u0398 0= \u0398. Given xt, the\nresidual is defined by rt:=xt\u2212fd(xt\u22121)\u2212g(xt\u22121)ut\u22121,\nand it holds that rt+ [\u03d5(xt\u22121)]\u22a4\u03b8\u2217\u2208 W, which means\n\u03b8\u2217\u2208\u2206\u03b8,twith the non-falsified set \u2206 \u03b8,tgiven by\n\u2206\u03b8,t=\b\n\u03b8\u2208Rp|Hw[\u03d5(xt\u22121)]\u22a4\u03b8\u22641\u2212Hwrt\t\n.(21)\nThe set estimate is updated as\n\u0398t+1= \u0398 t\u2229\u2206\u03b8,t. (22)\nFor the point estimate, a prior is first computed based\non the RLS estimation as\n\u02c6\u03b8[p]\nt+1=\u02c6\u03b8t\u2212\u00b5t\u03d5(xt\u22121)\u0010\nxt\u2212f(xt\u22121, ut\u22121;\u02c6\u03b8t)\u0011\n,(23)\n5\n\n--- Page 6 ---\nwhere \u00b5t\u2208(0,[\u2225\u03d5(xt\u22121)\u22252]\u22121) is the learning rate.\nThe final updated estimate \u02c6\u03b8t+1is computed by set-\nmembership projection as\n\u02c6\u03b8t+1= \u03a0 \u0398t+1(\u02c6\u03b8[p]\nt+1), (24)\nand\u03b4\u03b8,tin (13) can be obtained accordingly. It is clear\nthat\u03b4\u03b8,tis determined by Ft, and therefore ut, as com-\nputed as in (19), also depends on Ft. In short, causality\nis ensured by synchronizing the estimates \u02c6\u03b8tand \u0398 twith\ntheone-step-delayed information flow Ft\u22121.\nAlgorithm 1 Robust Adaptive Safe Control\nRequire: x0,\u02c6\u03b80, \u0398,w,LB, \u0393,{\u03c0nom,t}T\u22121\nt=0\n\u03980\u2190\u0398,\u00b50\u21900, \u2206 \u03b8,0\u2190Rp\nfort= 0 to T\u22121do\nCompute \u03b5\u03b8,t(p) \u25b7(11b)\nCompute \u02c6\u03b8t+1and\u03b4\u03b8,t \u25b7(21)\u2013(24), (13)\nDetermine Uras(x;\u02c6\u03b8t, p) \u25b7(16)\nCompute utusing the safety filter \u25b7(19)\nObtain xt+1by applying ut\nend for\nAlgorithm 1 outlines the core steps of the proposed ro-\nbust adaptive safe control with online estimation. The\nrequired inputs are the initial state x0, initial estimates\n\u02c6\u03b80and \u0398, constant parameters w,LB, and \u0393, along with\nnominal policies {\u03c0nom,t}T\u22121\nt=0. At time step t,\u02c6\u03b8tand\u03b4\u03b8,t\nare first computed to define Uras(x;\u02c6\u03b8t, p), and \u02c6\u03b8t+1and\n\u0398t+1will be used at t+ 1. Given Uras(x;\u02c6\u03b8t, p), a safe ut\nis then computed using the safety filter, and the system\nstate evolves to xt+1. It is also worth noting that, under\nAlgorithm 1, we have \u0398 1= \u0398 0and\u02c6\u03b81=\u02c6\u03b80, meaning\nthe non-trivial update starts from t= 1.\nRemark 6 The safe control scheme in Algorithm 1 also\napplies when the 1-norm error bound \u03b5\u03b8,t(1)is used.\nMoreover, given a model-based baseline policy \u03c0nom, the\nnominal policies {\u03c0nom,t}T\u22121\nt=0can also be generated by\ncombining EST, following the certainty-equivalence prin-\nciple in adaptive control with online estimation [22], [26].\n5 Inherent robustness\nInspired by [46], we discuss the inherent robustness prop-\nerty of the CBC in (16). Specifically, when xt0is only\nsafe but not robustly safe (i.e., xt0\u2208 S \\ S ra,t0) or even\nunsafe (i.e., xt0/\u2208 S) for some t0\u2208Ndue to unexpected\nperturbations [46] or poor parameter estimates, inher-\nent robustness ensures that the safe inputs derived from\nthe safety filter (19) based on the CBC (16) are able to\nsteer the state towards the sequence of robust adaptive\nsafe sets {Sra,t}\u221e\nt=t0asymptotically, i.e., xt\u2208 Sra,twhen\nt\u2192 \u221e . This asymptotic convergence w.r.t. a sequence\nof sets is formally given as follows:Definition 5 Assume that {Xt}\u221e\nt=0withXt\u2286Xis se-\nquentially positively invariant (cf. Definition 3) for a\ngeneral time-varying system xt+1=ht(xt) +wtfor all\nwt\u2208 W, where ht:X \u2192Rnis continuous for all t\u2208N.\nThen xtconverges to {Xt}\u221e\nt=0asymptotically on Xif\nlimt\u2192\u221edistXt(xt) = 0 for all x0\u2208X.\nFollowing (15), we define the corresponding time-varying\nenergy functions on Xas follows:\nVt(x) =\u001a0 if x\u2208 Sra,t\n\u2212Bra,t(x) if x\u2208 X \\ S ra,t,\u2200t\u2208N.(25)\nIt is obvious that \u2200t\u2208N, Vt(x)>0 for x\u2208 X \\ S ra,t.\nGiven that Sra,tis sequentially positively invariant (see\nAppendix A), Vtcan be used to show that xtconverges\nto{Sra,t}\u221e\nt=0asymptotically if the input utsatisfies (16),\nwhich is stated in the following theorem.\nTheorem 3 (Inherent robustness guarantee) Let\nAssumption 1 hold. If B:X \u2192 Ris a robust adaptive\nDT-CBF for (6)andESTforT=\u221e(cf. Definition 4),\nthenxtconverges to {Sra,t}\u221e\nt=0asymptotically on X(cf.\nDefinition 5) for the system (6)withut\u2208 Uras(xt;\u02c6\u03b8t, p).\nThe proof of Theorem 3 is provided in Appendix C. The-\norem 3 directly implies that a sequence of inputs certi-\nfied by (16) ensure that xt\u2208 Sra,twhen t\u2192 \u221e . More-\nover, although Sra,tdoes not generally converge to S,\nthe asymptotic convergence of {Sra,t}\u221e\nt=0is not affected.\nAs discussed in Remark 4, maximized error bound-based\nCBFs [25] can also be used to establish safety, though\ntheir induced CBC is more conservative than (16). How-\never, the maximized error bound can exhibit a mono-\ntonicity property [25], which can cause the resulting se-\nquence of safe sets to converge to Sunder mild condi-\ntions. In this case, the inherent robustness property also\nholds, and more details are given in Appendix C.\n6 Application Example\nIn this section, we consider the ACC problem, which\nis frequently used as a benchmark in safe control using\nCBFs [4], [24], [38], [45]. The continuous-time model of\nthe ego vehicle is given by\n\"\n\u02d9v\n\u02d9d#\n=\"\n\u22121\nMFr(v)\nvf\u2212v#\n+\"\n1\nM\n0#\nu+\"\nwv\nwd#\n, (26)\nwhere vanddrepresent the velocity of the ego vehicle\nand the distance between the ego vehicle and the front\nvehicle, respectively. The parameter Mdenotes the effec-\ntive mass of the ego vehicle. The nominal velocity of the\nfront vehicle, denoted by vf, is unknown but constrained\nwithin a known interval [ vlb, vub]. The control input u\nrepresents the traction force applied by the ego vehicle,\nwhile the resistance force Fr(v) accounts for drag effects\nand is modeled as Fr(v) =Froll+\u00b5visv+\u00b5aerov2for\n6\n\n--- Page 7 ---\nv >0, where Frollis the Coloumb friction force, \u00b5visis\nthe viscous force coefficient, and \u00b5aerois the aerodynamic\ndrag coefficient [38], [45]. Both Frolland\u00b5visare deter-\nmined empirically offline [45], whereas \u00b5aerois identified\nonline. The disturbance wvis included to capture ve-\nlocity changes due to unmodeled resistance forces (e.g.,\nwind effects), and wdcharacterizes stochastic variations\nofvf. These disturbances are bounded as |wv| \u2264wv\nand|wd| \u2264wd, and the aerodynamic coefficient satisfies\n\u00b5aero\u2208[\u00b5\u2212, \u00b5+], where wv,wd,\u00b5\u2212, and \u00b5+are known\nconstants. For simplicity and real-time computational\nefficiency [11], [37], forward Euler discretization is ap-\nplied to obtain the discrete-time model as\n\"\nvt+1\ndt+1#\n=\"\nvt\u2212\u2206t\nMFr(vt)\ndt+\u2206t(vf\u2212vt)#\n+\"\n\u2206t\nM\n0#\nut+\"\nwv,t\u2206t\nwd,t\u2206t#\n,(27)\nwhere \u2206 t= 0.1[s] is the sampling period. The dis-\ncretized ACC model (27) is consistent with (1) with box-\nconstrained wt= [wv,t\u2206t, wd,t\u2206t]\u22a4and\u03b8= [\u00b5aero, vf]\u22a4\nsuch that (2) and (3) are satisfied. The safety constraint\nisd\u22651.8v[38], and the barrier function Bis chosen\nasB(v, d) =d\u22121.8v\u2212a, where a\u22650 is user-specified\nsafety margin. The nominal controller is an adaptive\nMPC controller equiped with ESTusing the certainty-\nequivalence principle [20], [22], [26], and the objective of\nthe MPC is to track a reference velocity vref= 30[m /s].\n0 2 4 6 8 100.20.40.6\n\u02c6\u00b5aero \u00b5\u2217\naero\n0 2 4 6 8 10\nTime[s]2530\n\u02c6vf v\u2217\nf\nFig. 1. ESTestimation performance. The shaded area is the\nmin-max envelope encompassing different disturbance real-\nizations.\nThe simulations4are conducted using Python 3.12. The\nperformance of the online parameter estimation module\nESTis illustrated in Figure 1, which demonstrates that\nthe true parameters are accurately recovered over time.\nThe results related to safety are presented in Figure 2.\nAs shown in the middle subplot, the proposed robust\nadaptive CBF-based safety filter ensures constraint sat-\nisfaction even in the presence of disturbances and model\nmismatch. This is achieved by actively modifying unsafe\n4The full codebase and specific implementations are avail-\nable at: https://github.com/lcrekko/ra cbfmpc.control inputs when safety is at risk, as evidenced in the\nbottom subplot of the same figure.\nBased on Figure 2, the need for an explicit safety mecha-\nnism becomes apparent when comparing with the base-\nline adaptive MPC controller, which fails to enforce the\nsafety constraint. Although the robust CBF controller\nalso maintains safety, it reacts more slowly to critical\nsituations compared to the robust adaptive CBF ap-\nproach. As a result, from approximately 7 seconds on-\nward, stronger braking actions\u2013i.e., more conservative\ncontrol inputs\u2013are required to uphold safety.\n2530v[m/s]aMPC-raCBF MPC-rCBF aMPC\n050d\u22121.8v[m]\n0 2 4 6 8 10\nTime[s]\u2212505u[N]\u00d710329.2529.5029.75\n46\n\u22125000\u22124000\u22123000\nFig. 2. Comparison of adaptive MPC with robust adaptive\nCBF-based safety filter (aMPC-raCBF), MPC with worst\u2013\ncase robust CBF-based safety filter (MPC-rCBF), and adap-\ntive MPC (aMPC). The shaded area is the min-max envelope\nencompassing different disturbance realizations. Zoomed-in\nsubplot is provided for each subfigure.\n7 Conclusions\nIn this paper, we have developed a safe control method\nfor discrete-time systems using robust adaptive discrete-\ntime control barrier functions (CBFs), considering both\nparametric model uncertainty and disturbances. Unlike\ntraditional approaches in continuous-time adaptive safe\ncontrol design that tightly couple adaptation and con-\ntrol, our framework supports a modular architecture\nwhere the parameter learning algorithm operates inde-\npendently of the safety filter. This separation simpli-\nfies safe control design and supports greater flexibility\nin implementation. In addition, the proposed method\nprovides rigorous guarantees of safety without requiring\nexact model knowledge, which is particularly valuable\nfor safety-critical applications where online adaptation\n7\n\n--- Page 8 ---\nis necessary. Future research directions include subopti-\nmality analysis of safe control using CBFs and extension\nto distributed safe control of multi-agent systems.\nA Proof of Theorem 2\nPROOF. It suffices to prove robust safety through pos-\nitive invariance. Considering Bra,t+1(xt+1)\u2212Bra,t(xt),\nwhich characterizes the incremental value of the barrier\nfunction, it holds that\nBra,t+1(xt+1)\u2212Bra,t(xt)\n=B(xt+1)\u2212B(xt)\u22121\n2(e\u03b8,t+1\u2212e\u03b8,t)\u22a4\u0393\u22121(e\u03b8,t+1+e\u03b8,t)\n(13)=B(xt+1)\u2212B(xt)\u22121\n2\u03b4\u22a4\n\u03b8,t\u0393\u22121(\u03b4\u03b8,t+ 2e\u03b8,t)\n\u2265B(xt+1)\u2212B(xt)\u2212\u2225\u03b4\u03b8,t\u22252+ 2\u2225\u03b4\u03b8,t\u2225\u03b5\u03b8,t(p)\n2\u03bbmin(\u0393),(A.1)\nwhere B(xt+1)\u2212B(xt) can be lower bounded as\nB(xt+1)\u2212B(xt)\n=B(f(xt, \u03c0t(xt);\u03b8\u2217) +wt)\u2212B(xt)\n(9)\n\u2265B(f(xt, \u03c0t(xt);\u02c6\u03b8t))\u2212B(xt)\u2212LB(\u2225\u03d5(xt)\u2225\u03b5\u03b8,t(p)+w).\nBy substituting the above equation into (A.1) and using\nthe fact that \u03c0t(xt) satisfies (16), we have\nBra,t+1(xt+1)\u2212Bra,t(xt)\n\u2265 \u2212\u03b1\u0012\nB(xt)\u2212(\u03b5\u03b8,t(p))2\n2\u03bbmin(\u0393)\u0013\n\u2265 \u2212\u03b1(Bra,t(xt)).(A.2)\nBased on (A.2), if xt\u2208 S ra,t, i.e., Bra,t(xt)\u22650, then\nBra,t+1(xt+1)\u2265Bra,t(xt)\u2212\u03b1(Bra,t(xt))\u22650 since \u03b1\u2208\nCSL, which implies xt+1\u2208 S ra,t+1. Thus, {Sra,t}T\nt=0is\nsequentially positive invariant for the closed-loop system\n(18) given \u03c0t(x)\u2208 Uras(x;\u02c6\u03b8t, p). Moreover, noting that\nBra,t(x)\u22650 =\u21d2B(x)\u22650, (A.2) indicates that SBis\npositive invariant for (18) over I[0:T]. 2\nB Robustified CBFs with error bounds\nThe true error e\u03b8,tis used to construct Bra,tin (14) to\nachieve adaptive safety, which is similar to [38]. Although\nsafety can be established, {Sra,t}T\nt=0cannot be charac-\nterized since e\u03b8,tis unknown. Considering that the ulti-\nmate goal is to achieve safety w.r.t. SB, which encodes\nsafety [25], [38], the proposed method using Bra,tdefined\nin (14) is still valid since Sra,t\u2286 SB.\nAn alternative is using the set-induced error bound \u03b7\u03b8,t\nsatisfying |e\u03b8,t| \u2264\u03b7\u03b8,tto construct robustified CBFs [25].\nSpecifically, for all i\u2208I[1:q],\u03b7\u03b8,t[i] can be computed as\n\u03b7\u03b8,t[i] = max\n\u03b8\u2208\u0398t\u03b8[i]\u2212min\n\u03b8\u2208\u0398t\u03b8[i]. (B.1)The bound in (B.1) is conservative since it is solely\ncomputed using \u0398 t. Besides, the max (min) operation\nprevents obtaining an analytical expression of its time\nderivative, and proving set invariance in continuous-time\nsettings has to resort to the true error instead of the\nbound itself that is used to construct the CBF (see the\nproof of [25, Theorem 2]). The consequence is that, in\nthe continuous-time setting, it is impossible5to estab-\nlish the invariance property of the safe sets defined by\nthe robustified CBFs constructed using the error bound.\nLuckily, in the discret-time setting, such invaraince prop-\nerty can be established since no derivative is required.\nDefine the error-bound robust adaptive CBF by\nBra,t(x) :=B(x)\u22121\n2\u03b7\u22a4\n\u03b8,t\u0393\u22121\u03b7\u03b8,t, (B.2)\nwhere \u0393 is a symmetric positive definite matrix. Similar\nto (15), the safe set corresponding to Bra,tis given by\nSra,t={x\u2208 X | Bra,t(x)\u22650}. (B.3)\nFollowing Definition 4, a modified version based on (B.2)\nand (B.3) is given as follows:\nDefinition 6 Let Assumption 1 hold. Given ESTand\nT\u2208N, A continuous function B:X \u2192Ris an error-\nbound robust adaptive DT-CBF for (6)and EST on\n{Sra,t}T\nt=0if there exists \u03b1\u2208 K e,\u221e\u2229 CSLsuch that, for\nallx\u2208 X, there exists u\u2208 Usatisfying\nB\u0000\nf(x, u;\u02c6\u03b8t)\u0001\n\u2212B(x)\u2212LBw\u2212E\u03b7,t(x)\n\u2265 \u2212\u03b1\u0012\nB(x)\u2212\u2225\u03b7\u03b8,t\u22252\n2\u03bbmin(\u0393)\u0013\n,\u2200t\u2208I[0:T\u22121](B.4)\nwhere E\u03b7,t(x) =\u0010\nLB\u2225\u03d5(x)\u2225+\u2225\u03b4\u03b7,t\u2225\n\u03bbmin(\u0393)\u0011\n\u03b7\u03b8,t+\u2225\u03b4\u03b7,t\u22252\n2\u03bbmin(\u0393)\nwithLBbeing the Lipschitz constant in (9)and\u03b4\u03b7,t=\n\u03b7\u03b8,t+1\u2212\u03b7\u03b8,t. In this case, the condition (B.4) is called the\nerror-bound robust adaptive CBC against disturbances\nand parametric model mismatch.\nThe certificate (B.4) also defines a set of safe inputs for\n{Sra,t}T\nt=0as\nUras(x;\u02c6\u03b8t) ={u\u2208 U | (B.4) holds }. (B.5)\nFollowing Theorem 2, a modified safety guarantee that\nuses the certificate (B.4) is given as follows:\nTheorem 4 Let Assumption 1 hold and assume x0\u2208\nSra,0. Given ESTandT\u2208N, IfB:X \u2192Ris an error-\nbound robust adaptive DT-CBF for the system (6)and\nESTon{Bra,t}T\nt=0, then the set Uras(x;\u02c6\u03b8t)is non-empty\nfor all x\u2208 X and all t\u2208I[0,T\u22121]. In addition, if a\nsequence of time-varying state-feedback control policies\n5Noting that, in the proof of [25, Theorem 2], h\u2265hr\u2212\n1\n2\u02dc\u03d1\u22a4\u0393\u22121\u02dc\u03d1andh\u22650 cannot lead to hr\u22121\n2\u02dc\u03d1\u22a4\u0393\u22121\u02dc\u03d1\u22650.\n8\n\n--- Page 9 ---\n\u03c0t:X \u2192 Rm, t\u2208I[0,T\u22121]satisfies \u03c0t(x)\u2208Uras(x;\u02c6\u03b8t)\nfor all x\u2208 X, then the time-varying closed-loop system\nxt+1=f(xt,\u03c0t(xt);\u03b8\u2217) +wt (B.6)\nis robustly safe w.r.t. {Sra,t}T\nt=0and thus robustly safe\nw.r.t.SBoverI[0:T](cf. Definition 3) against both para-\nmetric model mismatch and disturbances.\nThe proof of Theorem 4 is similar to that of Theorem 2\nin Appendix A and is therefore omitted for brevity.\nRemark 7 The advantage of using \u03be\u03b8,tto design the\nsafety certificate is that the safe set Bra,tcan be explic-\nitly determined. Moreover, it holds that \u03b7\u03b8,t+1\u2264\u03b7\u03b8,tif\n\u0398t+1\u2286\u0398t, leading to Sra,t\u2286Sra,t+1(i.e., the safe set\nis gradually expanding).\nC More on Inherent Robustness\nWe first prove Theorem 3 using Vtdefined in (25). The\nproof is inspired by the proof of [30, Theorem B.13].\nPROOF. If there exists a t0\u2208Nsuch that xt0\u2208 Sra,t0,\nthen xt\u2208 S ra,tholds for all t\u2208I[t0:\u221e]by Theorem 2\nsince{Bra,t}\u221e\nt=0is sequentially positive invariant for the\nsystem (6) with ut\u2208 Uras(xt;\u02c6\u03b8t, p). Thus, in this case,\nlimt\u2192\u221e1(xt\u2208 Sra,t) = 1. On the other hand, assume\nxt\u2208 X \\ S ra,t; then we have\nVt(xt+1)\u2212Vt(xt)(25)=Bra,t(xt)\u2212Bra,t+1(xt+1)\n(A.2)\n\u2264\u03b1(Bra,t(xt))<0,(C.1)\nwhere the last inequality is due to Bra,t(xt)<0 for\nxt\u2208 X \\ S ra,tand\u03b1\u2208 K e,\u221e. Consider the sequence\n{Vt(xt)}\u221e\nt=0; given that Vt(xt)\u22650 and (C.1), by the\nmonotone convergence theorem [31], there exists a V\u2217\u2265\n0 such that lim t\u2192\u221eVt(xt) =V\u2217. Equivalently, \u2200\u03f5 >0,\n\u2203T\u2217(\u03f5) such that \u2200t\u2265T\u2217(\u03f5),Vt(xt)\u2212V\u2217< \u03f5. Next, we\nprove that V\u2217= 0 by contradiction. Assume V\u2217>0,\nand let \u03f5=\u2212\u03b1(\u2212V\u2217). Then, for any t\u2265T\u2217(\u2212\u03b1(\u2212V\u2217)),\nit holds that (i) V\u2217\u2264Vt(xt)< V\u2217\u2212\u03b1(\u2212V\u2217) and (ii)\nV\u2217\u2264Vt+1(xt+1)< V\u2217\u2212\u03b1(\u2212V\u2217), implying Vt+1(xt+1)\u2212\nVt(xt)> \u03b1(\u2212V\u2217). On the other hand, by (C.1), we have\nVt+1(xt+1)\u2212Vt(xt)\u2264\u03b1(\u2212V\u2217), which leads to a con-\ntradiction. Therefore, lim t\u2192\u221eVt(xt) = V\u2217= 0, i.e.,\nlimt\u2192\u221edistSra,t(xt) = 0. 2\nIn fact, following the discussion in Appendix B, by con-\nstructing a sequence of energy functions using Sra,t, it\ncan been shown that the safe control input characterized\nby the certificate (B.4) also has the inherent robustness\nproperty, which is summarized in the following theorem:Theorem 5 Let Assumption 1 hold. If B:X \u2192 R\nis an error-bound robust adaptive DT-CBF for (6)\nand ESTforT= +\u221e(cf. Definition 6, then xtcon-\nverges to {Sra,t}\u221e\nt=0defined by the robust adaptive CBFs\n{Bra,t}\u221e\nt=0asymptotically (cf. Definition 5) on Xfor the\nsystem (6)withut\u2208Uras(xt;\u02c6\u03b8t).\nTheorem 5 implies that xtwill be regulated towards the\nsafe sets {Sra,t}\u221e\nt=0asymptotically on Xfor the closed-\nloop system (B.6). The proof of Theorem 5 closely fol-\nlows that of Theorem 3 given above and is therefore\nomitted for brevity.\nReferences\n[1] N. Agarwal, B. Bullins, E. Hazan, S. Kakade, and K. Singh.\nOnline control with adversarial disturbances. In International\nConference on Machine Learning , pages 111\u2013119. PMLR,\n2019.\n[2] A. Agrawal and K. Sreenath. Discrete control barrier\nfunctions for safety-critical control of discrete systems with\napplication to bipedal robot navigation. In Proceedings of\nRobotics: Science and Systems , Cambridge, Massachusetts,\nJuly 2017.\n[3] A. D. Ames, S. Coogan, M. Egerstedt, G. Notomista,\nK. Sreenath, and P. Tabuada. Control barrier functions:\nTheory and applications. In 2019 18th European Control\nConference (ECC) , pages 3420\u20133431, 2019.\n[4] A. D. Ames, X. Xu, J. W. Grizzle, and P. Tabuada.\nControl barrier function based quadratic programs for safety\ncritical systems. IEEE Transactions on Automatic Control ,\n62(8):3861\u20133876, 2016.\n[5] S. Bansal, M. Chen, S. Herbert, and C. J. Tomlin. Hamilton-\nJacobi reachability: A brief overview and recent advances. In\n2017 IEEE 56th Annual Conference on Decision and Control\n(CDC) , pages 2242\u20132253, 2017.\n[6] N. Bof, R. Carli, and L. Schenato. Lyapunov theory for\ndiscrete time systems. arXiv preprint arXiv:1809.05289 ,\n2018.\n[7] S. P. Boyd and L. Vandenberghe. Convex Optimization .\nCambridge University Press, 2004.\n[8] Y. Chen, H. Peng, and J. W. Grizzle. Obstacle avoidance for\nlow-speed autonomous vehicles with barrier function. IEEE\nTransactions on Control Systems Technology , 26(1):194\u2013206,\n2017.\n[9] M. H. Cohen and C. Belta. Modular adaptive safety-critical\ncontrol. In 2023 American Control Conference (ACC) , pages\n2969\u20132974, 2023.\n[10] M. H. Cohen and C. Belta. Safe exploration in model-\nbased reinforcement learning using control barrier functions.\nAutomatica , 147:110684, 2023.\n[11] D. Corona and B. De Schutter. Adaptive cruise control\nfor a SMART car: A comparison benchmark for MPC-PWA\ncontrol methods. IEEE Transactions on Control Systems\nTechnology , 16(2):365\u2013372, 2008.\n[12] R. K. Cosner, P. Culbertson, and A. D. Ames. Bounding\nstochastic safety: Leveraging Freedman\u2019s inequality with\ndiscrete-time control barrier functions. IEEE Control\nSystems Letters , 8:1937\u20131942, 2024.\n9\n\n--- Page 10 ---\n[13] R. K. Cosner, P. Culbertson, A. J. Taylor, and A. D. Ames.\nRobust safety under stochastic uncertainty with discrete-time\ncontrol barrier functions. In Proceedings of Robotics: Science\nand Systems , Daegu, Republic of Korea, July 2023.\n[14] R. K. Cosner, I. Sadalski, J. K. Woo, P. Culbertson, and A. D.\nAmes. Generative modeling of residuals for real-time risk-\nsensitive safety with discrete-time control barrier functions.\nIn2024 IEEE International Conference on Robotics and\nAutomation (ICRA) , pages i\u2013viii, 2024.\n[15] A. Didier and M. N. Zeilinger. Approximate predictive\ncontrol barrier function for discrete-time systems. arXiv\npreprint arXiv:2411.11610 , 2024.\n[16] F. Ferraguti, C. T. Landi, A. Singletary, H-C. Lin, A. D.\nAmes, C. Secchi, and M. Bonfe. Safety and efficiency in\nrobotics: The control barrier functions approach. IEEE\nRobotics & Automation Magazine , 29(3):139\u2013151, 2022.\n[17] R. A. Horn and R. Johnson C. Matrix Analysis . Cambridge\nUniversity Press, 2nd edition, 2012.\n[18] M. Jankovic. Robust control barrier functions for constrained\nstabilization of nonlinear systems. Automatica , 96:359\u2013367,\n2018.\n[19] R. L. Kosut, M. K. Lau, and S. P. Boyd. Set-membership\nidentification of systems with parametric and nonparametric\nuncertainty. IEEE Transactions on Automatic control ,\n37(7):929\u2013941, 2002.\n[20] C. Liu, S. Shi, and B. De Schutter. Certainty-equivalence\nmodel predictive control: Stability, performance, and beyond.\narXiv preprint arXiv:2412.10625 , 2024.\n[21] C. Liu, S. Shi, and B. De Schutter. Stability and performance\nanalysis of model predictive control of uncertain linear\nsystems. In 2024 IEEE 63rd Conference on Decision and\nControl (CDC) , pages 7356\u20137362, 2024.\n[22] C. Liu, S. Shi, and B. De Schutter. On the regret of model\npredictive control with imperfect inputs. IEEE Control\nSystems Letters , 9:601\u2013606, 2025.\n[23] L. Ljung. Perspectives on system identification. Annual\nReviews in Control , 34(1):1\u201312, 2010.\n[24] B. T. Lopez and J-J. E. Slotine. Unmatched control\nbarrier functions: Certainty equivalence adaptive safety. In\n2023 American Control Conference (ACC) , pages 3662\u20133668,\n2023.\n[25] B. T. Lopez, J-J. E. Slotine, and J. P. How. Robust\nadaptive control barrier functions: An adaptive and data-\ndriven approach to safety. IEEE Control Systems Letters ,\n5(3):1031\u20131036, 2020.\n[26] M. Lorenzen, M. Cannon, and F. Allg\u00a8 ower. Robust MPC\nwith recursive model update. Automatica , 103:461\u2013471, 2019.\n[27] W. Luo, W. Sun, and A. Kapoor. Sample-efficient safe\nlearning for online nonlinear control with control barrier\nfunctions. In International Workshop on the Algorithmic\nFoundations of Robotics , pages 419\u2013435. Springer, 2022.\n[28] H. Mania, M.I. Jordan, and B. Recht. Active learning for\nnonlinear system identification with guarantees. Journal of\nMachine Learning Research , 23(32):1\u201330, 2022.\n[29] H. Nijmeijer and A. van der Schaft. Nonlinear Dynamical\nControl Systems , volume 175. Springer, 1990.\n[30] J. B. Rawlings, D. Q. Mayne, and M. M. Diehl. Model\nPredictive Control: Theory, Computation, and Design . Nob\nHill Publishing, 2nd edition, 2017.\n[31] H. L. Royden and P. M. Fitzpatrick. Real Analysis . Prentice\nHall, 4th edition, 2010.[32] C. Santoyo, M. Dutreix, and S. Coogan. Verification and\ncontrol for finite-time safety of stochastic systems via barrier\nfunctions. In 2019 IEEE Conference on Control Technology\nand Applications (CCTA) , pages 712\u2013717, 2019.\n[33] S. H. Semnani, H. Liu, M. Everett, A. De Ruiter, and J. P.\nHow. Multi-agent motion planning for dense and dynamic\nenvironments via deep reinforcement learning. IEEE Robotics\nand Automation Letters , 5(2):3221\u20133226, 2020.\n[34] J. Shen, W. Wang, J. Zhou, and J. L\u00a8 u. Adaptive safety with\ncontrol barrier functions and triggered batch least-squares\nidentifier. Automatica , 173:112059, 2025.\n[35] M. Srinivasan, A. Dabholkar, S. Coogan, and P. A. Vela.\nSynthesis of control barrier functions using a supervised\nmachine learning approach. In 2020 IEEE/RSJ International\nConference on Intelligent Robots and Systems (IROS) , pages\n7139\u20137145, 2020.\n[36] P. Tabuada. Verification and Control of Hybrid Systems:\nA Symbolic Approach . Springer Science & Business Media,\n2009.\n[37] R. Takano, H. Oyama, and M. Yamakita. Application of\nrobust control barrier function with stochastic disturbance\nmodel for discrete time systems. IFAC-PapersOnLine ,\n51(31):46\u201351, 2018.\n[38] A. J. Taylor and A. D. Ames. Adaptive safety with control\nbarrier functions. In 2020 American Control Conference\n(ACC) , pages 1399\u20131405, 2020.\n[39] J. H. van Schuppen. Control and System Theory of Discrete-\nTime Stochastic Systems . Springer, 2021.\n[40] R. J. Vanderbei. Linear Programming: Foundations and\nExtensions . Springer, 5th edition, 2020.\n[41] T. L. Vu, S. Mukherjee, R. Huang, and Q. Huang. Barrier\nfunction-based safe reinforcement learning for emergency\ncontrol of power systems. In 2021 60th IEEE Conference on\nDecision and Control (CDC) , pages 3652\u20133657, 2021.\n[42] A. Wagenmaker, G. Shi, and K. G. Jamieson. Optimal\nexploration for model-based RL in nonlinear systems.\nAdvances in Neural Information Processing Systems ,\n36:15406\u201315455, 2023.\n[43] S. Wang and S. Wen. Safe control against uncertainty: A\ncomprehensive review of control barrier function strategies.\nIEEE Systems, Man, and Cybernetics Magazine , 11(1):34\u2013\n47, 2025.\n[44] Y. Wang and X. Xu. Adaptive safety-critical control for a\nclass of nonlinear systems with parametric uncertainties: A\ncontrol barrier function approach. Systems & Control Letters ,\n188:105798, 2024.\n[45] W. Xiao, C. Belta, and C. G. Cassandras. Adaptive control\nbarrier functions. IEEE Transactions on Automatic Control ,\n67(5):2267\u20132281, 2021.\n[46] X. Xu, P. Tabuada, J. W. Grizzle, and A. D. Ames.\nRobustness of control barrier functions for safety critical\ncontrol. IFAC-PapersOnLine , 48(27):54\u201361, 2015.\n[47] J. Zeng, B. Zhang, and K. Sreenath. Safety-critical model\npredictive control with discrete-time control barrier function.\nIn2021 American Control Conference (ACC) , pages 3882\u2013\n3889, 2021.\n[48] H. Zhou, Y. Song, and V. Tzoumas. Safe non-\nstochastic control of control-affine systems: An online convex\noptimization approach. IEEE Robotics and Automation\nLetters , 8(12):7873 \u2013 7880, 2023.\n10",
  "project_dir": "artifacts/projects/enhanced_cs.SY_2508.08153v1_Robust_Adaptive_Discrete_Time_Control_Barrier_Cert",
  "communication_dir": "artifacts/projects/enhanced_cs.SY_2508.08153v1_Robust_Adaptive_Discrete_Time_Control_Barrier_Cert/.agent_comm",
  "assigned_at": "2025-08-12T19:22:23.243542",
  "status": "assigned"
}